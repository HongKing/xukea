// wizard(function($) {	$.wizard = {		// wizard页面初始化		_init: function(){			$('.wizard_steps ul li:first').addClass('first');			$('.wizard_content .steps_page .step:first').show();			$('.wizard .button_bar .btn_prev').addClass('btn_disabled');			$('.wizard .button_bar .btn_complete').hide();						$('.wizard .button_bar .btn_prev').live('click', $.wizard.click_btn_prev);			$('.wizard .button_bar .btn_next').live('click', $.wizard.click_btn_next);						// 打开第一个页面			var flag = true;			$('.wizard_steps ul li').each(function(i, o){				if(!$(o).hasClass('disable') && flag){					$.wizard._change_step_page(i, null, o);					flag = false;				}			});		},		// 设置进度条		_set_progress: function(step_num){			var step_multiplyby = (100 / $('.wizard_steps > ul > li').size());			var prog_val = (step_num*step_multiplyby);						$( ".wizard_progressbar").progressbar({ value: prog_val });		},		// 切换页面		_change_step_page: function(i, this_li, next_li){			$(this_li).removeClass('current');			$(next_li).addClass('current');						var url   = $(next_li).attr('url');			var parms = $(next_li).attr('data');			var id    = "step_" + i;			var next_step = $('.wizard_content .steps_page').children('#'+id);						if(next_step.length==0){				$.ajax({					url  : url,					data : $.parseJSON(parms),					success : function( data, status, xhr ){						$('.wizard_content .steps_page').append('<div id="'+ id +'" class="step">'+ data +'</div>');						// set tips						try{							$(function(){ $('.tips').tipsy({gravity: 's',html: true}); });							$(function(){ $('.tips-right').tipsy({gravity: 'w',html: true}); });							$(function(){ $('.tips-left').tipsy({gravity: 'e',html: true}); });							$(function(){ $('.tips-bottom').tipsy({gravity: 'n',html: true}); });						}catch(e){}						$('.wizard_content .steps_page').children('#'+id).fadeIn(1000);					}				});			}			$.wizard._set_progress(i+1);			try{				$("#messager_box").empty();//消息框置空			}catch(e){}			$('.wizard_content .steps_page').children().hide();			$('.wizard_content .steps_page').children('#'+id).fadeIn(1000);						return false;		},		// 按钮“上一步”点击事件		click_btn_prev: function(){			if($(this).hasClass('btn_disabled')) return;			var flag = false;			var prev_idx = null;			var prev_obj = null;			$('.wizard_steps ul li').each(function(i, o){				if($(o).hasClass('disable') || flag) return;								if($(o).hasClass('current')){					flag = true;					$.wizard._change_step_page(prev_idx, o, prev_obj);					var objs = $(o).prevAll('li:not(".disable")');					if(objs.size()==1){						$('.wizard .button_bar .btn_prev').addClass('btn_disabled');					}else{						$('.wizard .button_bar .btn_next').show();						$('.wizard .button_bar .btn_complete').hide();					}				}else{					prev_idx = i;					prev_obj = o;				}			});		},		// 按钮“下一步”点击事件		click_btn_next: function(){			if($(this).hasClass('btn_disabled')) return;						var flag = false;			var this_obj = null;			$('.wizard_steps ul li').each(function(i, o){				if($(o).hasClass('disable') || flag) return;								if($(o).hasClass('current')){					this_obj = o;				}else if(this_obj!=null){					flag = true;					var next_handle = $.trim( $(this_obj).attr('next_handle') );//获取当前页面的检测函数					if(next_handle.length>0){						try{							var temp = eval("("+next_handle+"())");							if(!temp) return; //如果检测不通过，则不进入下一个页面						}catch(e){}					}										$.wizard._change_step_page(i, this_obj, o);					var objs = $(o).nextAll('li:not(".disable")');					if(objs.size()==0){						$('.wizard .button_bar .btn_next').hide();						$('.wizard .button_bar .btn_complete').show();					}else{						$('.wizard .button_bar .btn_prev').removeClass('btn_disabled');					}				}			});		},		// 设置第“idx”步不可用		disable: function(idx, flag){			$('.wizard_steps ul li').each(function(i, o){				if(idx==i){					flag ? $(o).addClass("disable") : $(o).removeClass("disable") ;				}			});			$('.wizard_content .steps_page').children('#step_'+idx).remove();		},		// 设置第“idx”步的传递参数		setParms: function(idx, parms){			$('.wizard_steps ul li').each(function(i, o){				if(idx==i){					$(o).attr("data", $.stringify(parms));				}			});			$('.wizard_content .steps_page').children('#step_'+idx).remove();		},		// 获取第“idx”步的传递参数		getParms: function(idx){			var parms="";			$('.wizard_steps ul li').each(function(i, o){				if(idx==i){					parms = $(o).attr("data");				}			});			return $.parseJSON(parms);		},		// 更改第“idx”步的URL		setUrl: function(idx, url, parms){			$('.wizard_steps ul li').each(function(i, o){				if(idx==i){					$(o).attr("url", url);				}			});			if(parms!=null){				$.wizard.setParms(idx, parms);			}			$('.wizard_content .steps_page').children('#step_'+idx).remove();		},		// 清空内容		clear: function(idx){			$('.wizard_content .steps_page').children('#step_'+idx).remove();		},		// 清空所有内容		clearAll: function(){			$('.wizard_steps ul li').each(function(i, o){				$.wizard.clear(i);			});		}	};		$(document).ready(function(){		$.wizard._init();	});})(jQuery);